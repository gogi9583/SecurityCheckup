{
  "info": {
    "id": "windows_defender_enabled",
    "name": "Windows Defender Enabled",
    "description": "Verifies that Windows Defender is enabled.",
    "failureAdvice": "Enable Windows Defender in the Settings app.",
    "extraInfo": {
      "failure_advice": "Enable Windows Defender in the Settings app.",
      "name": "Windows Defender Enabled",
      "description": "Verifies that Windows Defender is enabled.",
      "id": "windows_defender_enabled"
    }
  },
  "rootStep": {
    "class": "net.acomputerdog.securitycheckup.test.step.score.FinalStep",
    "contents": {
      "child": {
        "class": "net.acomputerdog.securitycheckup.test.step.flow.RequireThenStep",
        "contents": {
          "requiredStep": {
            "class": "net.acomputerdog.securitycheckup.test.step.log.AddDataMessageStep",
            "contents": {
              "formatMessage": "Protection technologies enabled: %s",
              "passthrough": {
                "class": "net.acomputerdog.securitycheckup.test.step.compare.ConstCompareStep",
                "contents": {
                  "comparison": {
                    "class": "net.acomputerdog.securitycheckup.test.comparison.EqualsComparison",
                    "contents": {
                      "inverted": false
                    }
                  },
                  "child": {
                    "class": "net.acomputerdog.securitycheckup.test.step.wmi.ClsPropertyStep",
                    "contents": {
                      "source": {
                        "class": "net.acomputerdog.securitycheckup.test.step.wmi.GetFirstClsObjStep",
                        "contents": {
                          "source": {
                            "namespace": "ROOT\\Microsoft\\SecurityClient",
                            "query": "SELECT * FROM ProtectionTechnologyStatus"
                          }
                        }
                      },
                      "property": "Enabled"
                    }
                  },
                  "value": {
                    "class": "java.lang.Boolean",
                    "value": true
                  }
                }
              }
            }
          },
          "passthrough": {
            "class": "net.acomputerdog.securitycheckup.test.step.flow.AverageEveryStep",
            "contents": {
              "subSteps": [
                {
                  "class": "net.acomputerdog.securitycheckup.test.step.score.BoolToScoreStep",
                  "contents": {
                    "child": {
                      "class": "net.acomputerdog.securitycheckup.test.step.log.AddDataMessageStep",
                      "contents": {
                        "formatMessage": "Antispyware enabled: %s",
                        "passthrough": {
                          "class": "net.acomputerdog.securitycheckup.test.step.compare.ConstCompareStep",
                          "contents": {
                            "comparison": {
                              "class": "net.acomputerdog.securitycheckup.test.comparison.EqualsComparison",
                              "contents": {
                                "inverted": false
                              }
                            },
                            "child": {
                              "class": "net.acomputerdog.securitycheckup.test.step.reg.RegDefValueStep",
                              "contents": {
                                "defaultValue": {
                                  "class": "java.lang.Integer",
                                  "value": 0
                                },
                                "value": "DisableAntiSpyware",
                                "key": "SOFTWARE\\Microsoft\\Windows Defender",
                                "hive": "HKEY_LOCAL_MACHINE"
                              }
                            },
                            "value": {
                              "class": "java.lang.Integer",
                              "value": 0
                            }
                          }
                        }
                      }
                    }
                  }
                },
                {
                  "class": "net.acomputerdog.securitycheckup.test.step.score.BoolToScoreStep",
                  "contents": {
                    "child": {
                      "class": "net.acomputerdog.securitycheckup.test.step.log.AddDataMessageStep",
                      "contents": {
                        "formatMessage": "Antivirus enabled: %s",
                        "passthrough": {
                          "class": "net.acomputerdog.securitycheckup.test.step.compare.ConstCompareStep",
                          "contents": {
                            "comparison": {
                              "class": "net.acomputerdog.securitycheckup.test.comparison.EqualsComparison",
                              "contents": {
                                "inverted": false
                              }
                            },
                            "child": {
                              "class": "net.acomputerdog.securitycheckup.test.step.reg.RegDefValueStep",
                              "contents": {
                                "defaultValue": {
                                  "class": "java.lang.Integer",
                                  "value": 0
                                },
                                "value": "DisableAntiVirus",
                                "key": "SOFTWARE\\Microsoft\\Windows Defender",
                                "hive": "HKEY_LOCAL_MACHINE"
                              }
                            },
                            "value": {
                              "class": "java.lang.Integer",
                              "value": 0
                            }
                          }
                        }
                      }
                    }
                  }
                }
              ]
            }
          }
        }
      }
    }
  }
}