{
  "info": {
    "id": "av_installed",
    "name": "Antivirus Software Installed",
    "description": "Verifies that an antivirus product is installed.",
    "failureAdvice": "Install an antivirus application such as Avast, AVG, MalwareBytes, etc.",
    "extraInfo": {
      "failure_advice": "Install an antivirus application such as Avast, AVG, MalwareBytes, etc.",
      "name": "Antivirus Software Installed",
      "description": "Verifies that an antivirus product is installed.",
      "id": "av_installed"
    }
  },
  "rootStep": {
    "class": "net.acomputerdog.securitycheckup.test.step.score.FinalStep",
    "contents": {
      "child": {
        "class": "net.acomputerdog.securitycheckup.test.step.flow.RequireThenStep",
        "contents": {
          "requiredStep": {
            "class": "net.acomputerdog.securitycheckup.test.step.log.AddDataMessageStep",
            "contents": {
              "formatMessage": "Antivirus installed: %s",
              "passthrough": {
                "class": "net.acomputerdog.securitycheckup.test.step.compare.MatchAnyStep",
                "contents": {
                  "source": {
                    "class": "net.acomputerdog.securitycheckup.test.step.wmi.WMIStep",
                    "contents": {
                      "namespace": "ROOT\\SecurityCenter2",
                      "query": "SELECT * FROM AntiVirusProduct"
                    }
                  },
                  "match": {
                    "class": "net.acomputerdog.securitycheckup.test.step.data.PushStep",
                    "contents": {
                      "value": {
                        "class": "java.lang.String",
                        "value": "Windows Defender"
                      }
                    }
                  },
                  "comparison": {
                    "class": "net.acomputerdog.securitycheckup.test.comparison.WMIPropertyComparison",
                    "contents": {
                      "passthrough": {
                        "class": "net.acomputerdog.securitycheckup.test.comparison.EqualsComparison",
                        "contents": {
                          "inverted": true
                        }
                      },
                      "property": "displayName"
                    }
                  }
                }
              }
            }
          },
          "passthrough": {
            "class": "net.acomputerdog.securitycheckup.test.step.score.BoolToScoreStep",
            "contents": {
              "child": {
                "class": "net.acomputerdog.securitycheckup.test.step.log.AddDataMessageStep",
                "contents": {
                  "formatMessage": "Antivirus spectre-compatible: %s",
                  "passthrough": {
                    "class": "net.acomputerdog.securitycheckup.test.step.compare.ConstCompareStep",
                    "contents": {
                      "comparison": {
                        "class": "net.acomputerdog.securitycheckup.test.comparison.EqualsComparison",
                        "contents": {
                          "inverted": false
                        }
                      },
                      "child": {
                        "class": "net.acomputerdog.securitycheckup.test.step.reg.RegDefValueStep",
                        "contents": {
                          "defaultValue": {
                            "class": "java.lang.Integer",
                            "value": 1
                          },
                          "value": "cadca5fe-87d3-4b96-b7fb-a231484277cc",
                          "key": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\QualityCompat",
                          "hive": "HKEY_LOCAL_MACHINE"
                        }
                      },
                      "value": {
                        "class": "java.lang.Integer",
                        "value": 0
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}